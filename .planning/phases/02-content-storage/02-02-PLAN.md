---
phase: 02-content-storage
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - components/ui/button.tsx
  - components/ui/card.tsx
  - lib/utils.ts
  - tailwind.config.ts
  - package.json
autonomous: true

must_haves:
  truths:
    - "User can click Button components and see visual feedback"
    - "User can see content grouped in Card layouts"
    - "Button component renders different visual styles (primary, destructive, outline, etc.)"
    - "Card component creates visual hierarchy in options page"
  artifacts:
    - path: "components/ui/button.tsx"
      provides: "Shadcn Button component with variants"
      exports: ["Button", "buttonVariants"]
      min_lines: 30
    - path: "components/ui/card.tsx"
      provides: "Shadcn Card component"
      exports: ["Card", "CardHeader", "CardTitle", "CardContent"]
      min_lines: 50
    - path: "lib/utils.ts"
      provides: "Tailwind className utility"
      exports: ["cn"]
      min_lines: 5
  key_links:
    - from: "components/ui/button.tsx"
      to: "lib/utils.ts"
      via: "cn import"
      pattern: "import.*cn.*from.*utils"
    - from: "components/ui/card.tsx"
      to: "lib/utils.ts"
      via: "cn import"
      pattern: "import.*cn.*from.*utils"
---

<objective>
Set up Shadcn UI component library foundation for building the image management interface.

Purpose: Establish reusable UI components (Button, Card) that follow Shadcn conventions, enabling consistent styling and component composition in the options page.

Output: Shadcn Button and Card components with Tailwind v4 styling, plus cn() utility for className merging.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-content-storage/02-RESEARCH.md

# Existing Tailwind setup from Phase 01
@tailwind.config.ts
@postcss.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Shadcn dependencies and create utility</name>
  <files>lib/utils.ts, package.json</files>
  <action>
Install required dependencies for Shadcn UI components:
```bash
npm install class-variance-authority clsx tailwind-merge
npm install -D @types/react @types/react-dom
```

**Dependency rationale:**
- `class-variance-authority` (cva): Component variant system (e.g., button sizes/colors)
- `clsx`: Conditional className utility
- `tailwind-merge`: Merges Tailwind classes without conflicts

Create lib/utils.ts with cn() utility:
```typescript
import { type ClassValue, clsx } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
```

**Purpose of cn():**
Combines clsx (conditional classes) with tailwind-merge (deduplication), preventing Tailwind class conflicts like `"p-4 p-8"` (result: `"p-8"`).

**DO NOT:**
- Skip tailwind-merge (causes class conflicts)
- Create custom className merger (Shadcn standard is cn())
  </action>
  <verify>
Type check passes:
```bash
npm run type-check
```

Test cn() utility:
```typescript
// test.ts
import { cn } from './lib/utils';
console.log('cn works:', cn('p-4', 'p-8') === 'p-8');
console.log('cn conditional:', cn('base', true && 'active', false && 'hidden'));
```
```bash
npx tsx test.ts && rm test.ts
```
  </verify>
  <done>
- lib/utils.ts exists with cn() function
- Dependencies installed: class-variance-authority, clsx, tailwind-merge
- TypeScript types working
- cn() merges classes correctly
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Shadcn Button and Card components</name>
  <files>components/ui/button.tsx, components/ui/card.tsx</files>
  <action>
Create components/ui/button.tsx with Shadcn Button component:

**Button variants (using cva):**
- `default`: Primary blue button
- `destructive`: Red button for delete actions
- `outline`: Border-only button
- `secondary`: Gray button
- `ghost`: Transparent button with hover
- `link`: Text-only link style

**Button sizes:**
- `default`: Standard padding (h-10 px-4)
- `sm`: Small button
- `lg`: Large button
- `icon`: Square button for icons

**Component structure:**
```typescript
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"
import { cn } from "@/lib/utils"

const buttonVariants = cva(
  // Base styles (all buttons)
  "inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 disabled:opacity-50 disabled:pointer-events-none",
  {
    variants: {
      variant: { /* ... */ },
      size: { /* ... */ }
    },
    defaultVariants: {
      variant: "default",
      size: "default"
    }
  }
)

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, ...props }, ref) => {
    return (
      <button
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    )
  }
)
Button.displayName = "Button"

export { Button, buttonVariants }
```

Create components/ui/card.tsx with Shadcn Card components:

**Card subcomponents:**
- `Card`: Root container with border and shadow
- `CardHeader`: Top section with padding
- `CardTitle`: Title text with proper sizing
- `CardDescription`: Muted subtitle text
- `CardContent`: Main content area
- `CardFooter`: Bottom section for actions

**Component structure:**
```typescript
import * as React from "react"
import { cn } from "@/lib/utils"

const Card = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      "rounded-lg border bg-white text-gray-950 shadow-sm",
      className
    )}
    {...props}
  />
))
Card.displayName = "Card"

// Similar pattern for CardHeader, CardTitle, CardDescription, CardContent, CardFooter
```

**Tailwind v4 compatibility:**
- Use standard Tailwind classes (no v3-specific syntax)
- Rely on PostCSS rem-to-px conversion (already configured in Phase 01)
- Test classes work in Shadow DOM context

**DO NOT:**
- Use outdated Shadcn v1 styles (ensure modern Tailwind v4 classes)
- Skip forwardRef (needed for ref forwarding)
- Add custom colors not in Tailwind config
  </action>
  <verify>
Type check passes:
```bash
npm run type-check
```

Test component imports:
```typescript
// test.tsx
import { Button } from './components/ui/button';
import { Card } from './components/ui/card';
console.log('Button:', typeof Button);
console.log('Card:', typeof Card);
```
```bash
npx tsx test.tsx && rm test.tsx
```

Verify buttonVariants has all variants:
```typescript
// test.ts
import { buttonVariants } from './components/ui/button';
console.log('Has variants:', typeof buttonVariants);
```
```bash
npx tsx test.ts && rm test.ts
```
  </verify>
  <done>
- components/ui/button.tsx exists with Button component and variants
- components/ui/card.tsx exists with Card and subcomponents
- All components use cn() for className merging
- forwardRef used for ref support
- TypeScript types working
- Components follow Shadcn conventions
  </done>
</task>

</tasks>

<verification>
After completing both tasks:
1. lib/utils.ts exports cn() function
2. Button component has 5+ variants (default, destructive, outline, etc.)
3. Card component has subcomponents (CardHeader, CardTitle, CardContent, etc.)
4. All components use forwardRef for ref forwarding
5. Type checking passes
6. Dependencies installed: class-variance-authority, clsx, tailwind-merge
</verification>

<success_criteria>
- Shadcn UI foundation ready for options page UI
- Button and Card components reusable across extension
- Consistent styling system established
- Components work with existing Tailwind v4 + PostCSS setup from Phase 01
</success_criteria>

<output>
After completion, create `.planning/phases/02-content-storage/02-02-SUMMARY.md` with:
- Tech added (class-variance-authority, clsx, tailwind-merge)
- Key files created (components/ui/*, lib/utils.ts)
- Patterns established (Shadcn component conventions, cn() utility usage)
</output>
